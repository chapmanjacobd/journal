On btrfs there is offline dedupe via https://github.com/Zygo/bees but not prior to write checking
