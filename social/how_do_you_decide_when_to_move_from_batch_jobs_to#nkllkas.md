whether it's event driven or batches, sounds like you need a lock

https://man7.org/linux/man-pages/man1/flock.1.html
